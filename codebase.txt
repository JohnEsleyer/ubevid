--------------------------------------------------
FILE: .gitignore
--------------------------------------------------

# --- Dependencies ---
node_modules/
.bun-cache/

# --- Rust / Wasm ---
# Ignore the huge Rust build folder
core/target/

# Ignore the Wasm glue code generated by wasm-pack
# We ignore this because it is generated from the Rust source
core/pkg/

# --- Video Outputs ---
# Don't commit the videos you render
*.mp4
*.webm
*.mov
*.gif

# --- TypeScript ---
# Since we use Bun with "noEmit": true, we shouldn't have .js files 
# in the lib folder, but let's be safe.
lib/*.js
*.tsbuildinfo

# --- Environment & Secrets ---
.env
.env.local

# --- Logs & Debugging ---
npm-debug.log*
yarn-debug.log*
yarn-error.log*
bun-debug.log*

# --- OS / Editor ---
.DS_Store
.vscode/
.idea/
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?

--------------------------------------------------
FILE: README.md
--------------------------------------------------

# ubevid

To install dependencies:

```bash
bun install
```

To run:

```bash
bun run index.ts
```

This project was created using `bun init` in bun v1.3.6. [Bun](https://bun.com) is a fast all-in-one JavaScript runtime.


--------------------------------------------------
FILE: bun.lock
--------------------------------------------------

{
  "lockfileVersion": 1,
  "configVersion": 1,
  "workspaces": {
    "": {
      "name": "ubevid",
      "devDependencies": {
        "@types/bun": "latest",
      },
      "peerDependencies": {
        "typescript": "^5",
      },
    },
  },
  "packages": {
    "@types/bun": ["@types/bun@1.3.6", "", { "dependencies": { "bun-types": "1.3.6" } }, "sha512-uWCv6FO/8LcpREhenN1d1b6fcspAB+cefwD7uti8C8VffIv0Um08TKMn98FynpTiU38+y2dUO55T11NgDt8VAA=="],

    "@types/node": ["@types/node@25.0.10", "", { "dependencies": { "undici-types": "~7.16.0" } }, "sha512-zWW5KPngR/yvakJgGOmZ5vTBemDoSqF3AcV/LrO5u5wTWyEAVVh+IT39G4gtyAkh3CtTZs8aX/yRM82OfzHJRg=="],

    "bun-types": ["bun-types@1.3.6", "", { "dependencies": { "@types/node": "*" } }, "sha512-OlFwHcnNV99r//9v5IIOgQ9Uk37gZqrNMCcqEaExdkVq3Avwqok1bJFmvGMCkCE0FqzdY8VMOZpfpR3lwI+CsQ=="],

    "typescript": ["typescript@5.9.3", "", { "bin": { "tsc": "bin/tsc", "tsserver": "bin/tsserver" } }, "sha512-jl1vZzPDinLr9eUt3J/t7V6FgNEw9QjvBPdysz9KfQDD41fQrC2Y4vKQdiaUpFT4bXlb1RHhLpp8wtm6M5TgSw=="],

    "undici-types": ["undici-types@7.16.0", "", {}, "sha512-Zz+aZWSj8LE6zoxD+xrjh4VfkIG8Ya6LvYkZqtUQGJPZjYl53ypCaUwWqo7eI0x66KBGeRo+mlBEkMSeSZ38Nw=="],
  }
}


--------------------------------------------------
FILE: core/Cargo.lock
--------------------------------------------------

# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 4

[[package]]
name = "adler2"
version = "2.0.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "320119579fcad9c21884f5c4861d16174d0e06250625266f50fe6898340abefa"

[[package]]
name = "arrayref"
version = "0.3.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "76a2e8124351fda1ef8aaaa3bbd7ebbcb486bbcd4225aca0aa0d84bb2db8fecb"

[[package]]
name = "arrayvec"
version = "0.7.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "7c02d123df017efcdfbd739ef81735b36c5ba83ec3c59c80a9d7ecc718f92e50"

[[package]]
name = "autocfg"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "c08606f8c3cbf4ce6ec8e28fb0014a2c086708fe954eaa885384a6165172e7e8"

[[package]]
name = "bitflags"
version = "1.3.2"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bef38d45163c2f1dde094a7dfd33ccf595c92905c8f8f4fdc18d06fb1037718a"

[[package]]
name = "bumpalo"
version = "3.19.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5dd9dc738b7a8311c7ade152424974d8115f2cdad61e8dab8dac9f2362298510"

[[package]]
name = "bytemuck"
version = "1.24.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1fbdf580320f38b612e485521afda1ee26d10cc9884efaaa750d383e13e3c5f4"

[[package]]
name = "cfg-if"
version = "1.0.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9330f8b2ff13f34540b44e946ef35111825727b38d33286ef986142615121801"

[[package]]
name = "crc32fast"
version = "1.5.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9481c1c90cbf2ac953f07c8d4a58aa3945c425b7185c9154d67a65e4230da511"
dependencies = [
 "cfg-if",
]

[[package]]
name = "fdeflate"
version = "0.3.7"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1e6853b52649d4ac5c0bd02320cddc5ba956bdb407c4b75a2c6b75bf51500f8c"
dependencies = [
 "simd-adler32",
]

[[package]]
name = "flate2"
version = "1.1.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b375d6465b98090a5f25b1c7703f3859783755aa9a80433b36e0379a3ec2f369"
dependencies = [
 "crc32fast",
 "miniz_oxide",
]

[[package]]
name = "grid"
version = "0.10.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "eec1c01eb1de97451ee0d60de7d81cf1e72aabefb021616027f3d1c3ec1c723c"

[[package]]
name = "itoa"
version = "1.0.17"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "92ecc6618181def0457392ccd0ee51198e065e016d1d527a7ac1b6dc7c1f09d2"

[[package]]
name = "log"
version = "0.4.29"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5e5032e24019045c762d3c0f28f5b6b8bbf38563a65908389bf7978758920897"

[[package]]
name = "memchr"
version = "2.7.6"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "f52b00d39961fc5b2736ea853c9cc86238e165017a493d1d5c8eac6bdc4cc273"

[[package]]
name = "miniz_oxide"
version = "0.8.9"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1fa76a2c86f704bdb222d66965fb3d63269ce38518b83cb0575fca855ebb6316"
dependencies = [
 "adler2",
 "simd-adler32",
]

[[package]]
name = "num-traits"
version = "0.2.19"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "071dfc062690e90b734c0b2273ce72ad0ffa95f0c74596bc250dcfd960262841"
dependencies = [
 "autocfg",
]

[[package]]
name = "once_cell"
version = "1.21.3"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "42f5e15c9953c5e4ccceeb2e7382a716482c34515315f7b03532b8b4e8393d2d"

[[package]]
name = "png"
version = "0.17.16"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "82151a2fc869e011c153adc57cf2789ccb8d9906ce52c0b39a6b5697749d7526"
dependencies = [
 "bitflags",
 "crc32fast",
 "fdeflate",
 "flate2",
 "miniz_oxide",
]

[[package]]
name = "proc-macro2"
version = "1.0.106"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "8fd00f0bb2e90d81d1044c2b32617f68fcb9fa3bb7640c23e9c748e53fb30934"
dependencies = [
 "unicode-ident",
]

[[package]]
name = "quote"
version = "1.0.43"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "dc74d9a594b72ae6656596548f56f667211f8a97b3d4c3d467150794690dc40a"
dependencies = [
 "proc-macro2",
]

[[package]]
name = "rustversion"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b39cdef0fa800fc44525c84ccb54a029961a8215f9619753635a9c0d2538d46d"

[[package]]
name = "serde"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9a8e94ea7f378bd32cbbd37198a4a91436180c5bb472411e48b5ec2e2124ae9e"
dependencies = [
 "serde_core",
 "serde_derive",
]

[[package]]
name = "serde_core"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "41d385c7d4ca58e59fc732af25c3983b67ac852c1a25000afe1175de458b67ad"
dependencies = [
 "serde_derive",
]

[[package]]
name = "serde_derive"
version = "1.0.228"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d540f220d3187173da220f885ab66608367b6574e925011a9353e4badda91d79"
dependencies = [
 "proc-macro2",
 "quote",
 "syn",
]

[[package]]
name = "serde_json"
version = "1.0.149"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "83fc039473c5595ace860d8c4fafa220ff474b3fc6bfdb4293327f1a37e94d86"
dependencies = [
 "itoa",
 "memchr",
 "serde",
 "serde_core",
 "zmij",
]

[[package]]
name = "simd-adler32"
version = "0.3.8"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "e320a6c5ad31d271ad523dcf3ad13e2767ad8b1cb8f047f75a8aeaf8da139da2"

[[package]]
name = "slotmap"
version = "1.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "bdd58c3c93c3d278ca835519292445cb4b0d4dc59ccfdf7ceadaab3f8aeb4038"
dependencies = [
 "version_check",
]

[[package]]
name = "strict-num"
version = "0.1.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "6637bab7722d379c8b41ba849228d680cc12d0a45ba1fa2b48f2a30577a06731"

[[package]]
name = "syn"
version = "2.0.114"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "d4d107df263a3013ef9b1879b0df87d706ff80f65a86ea879bd9c31f9b307c2a"
dependencies = [
 "proc-macro2",
 "quote",
 "unicode-ident",
]

[[package]]
name = "taffy"
version = "0.3.19"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "b1315457ccd9c3def787a18fae91914e623e4dcff019b64ce39f5268ded53d3d"
dependencies = [
 "arrayvec",
 "grid",
 "num-traits",
 "slotmap",
]

[[package]]
name = "tiny-skia"
version = "0.11.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "83d13394d44dae3207b52a326c0c85a8bf87f1541f23b0d143811088497b09ab"
dependencies = [
 "arrayref",
 "arrayvec",
 "bytemuck",
 "cfg-if",
 "log",
 "png",
 "tiny-skia-path",
]

[[package]]
name = "tiny-skia-path"
version = "0.11.4"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9c9e7fc0c2e86a30b117d0462aa261b72b7a99b7ebd7deb3a14ceda95c5bdc93"
dependencies = [
 "arrayref",
 "bytemuck",
 "strict-num",
]

[[package]]
name = "ubevid_core"
version = "0.1.0"
dependencies = [
 "serde",
 "serde_json",
 "taffy",
 "tiny-skia",
 "wasm-bindgen",
]

[[package]]
name = "unicode-ident"
version = "1.0.22"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "9312f7c4f6ff9069b165498234ce8be658059c6728633667c526e27dc2cf1df5"

[[package]]
name = "version_check"
version = "0.9.5"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "0b928f33d975fc6ad9f86c8f283853ad26bdd5b10b7f1542aa2fa15e2289105a"

[[package]]
name = "wasm-bindgen"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "64024a30ec1e37399cf85a7ffefebdb72205ca1c972291c51512360d90bd8566"
dependencies = [
 "cfg-if",
 "once_cell",
 "rustversion",
 "wasm-bindgen-macro",
 "wasm-bindgen-shared",
]

[[package]]
name = "wasm-bindgen-macro"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "008b239d9c740232e71bd39e8ef6429d27097518b6b30bdf9086833bd5b6d608"
dependencies = [
 "quote",
 "wasm-bindgen-macro-support",
]

[[package]]
name = "wasm-bindgen-macro-support"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "5256bae2d58f54820e6490f9839c49780dff84c65aeab9e772f15d5f0e913a55"
dependencies = [
 "bumpalo",
 "proc-macro2",
 "quote",
 "syn",
 "wasm-bindgen-shared",
]

[[package]]
name = "wasm-bindgen-shared"
version = "0.2.108"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "1f01b580c9ac74c8d8f0c0e4afb04eeef2acf145458e52c03845ee9cd23e3d12"
dependencies = [
 "unicode-ident",
]

[[package]]
name = "zmij"
version = "1.0.16"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "dfcd145825aace48cff44a8844de64bf75feec3080e0aa5cdbde72961ae51a65"


--------------------------------------------------
FILE: core/Cargo.toml
--------------------------------------------------

[package]
name = "ubevid_core"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib"]

[dependencies]
wasm-bindgen = "0.2"
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
tiny-skia = "0.11"
taffy = "0.3"

--------------------------------------------------
FILE: core/src/lib.rs
--------------------------------------------------

use wasm_bindgen::prelude::*;
use tiny_skia::{Pixmap, Paint, Transform, Color, PixmapPaint};
use serde::{Deserialize, Serialize};
use taffy::prelude::*;
use fontdue::{Font, FontSettings};

// --- Embedded Font ---
// We include a basic font so the user doesn't have to provide one immediately.
static FONT_DATA: &[u8] = include_bytes!("../assets/Roboto-Regular.ttf"); 

#[derive(Deserialize, Serialize, Debug)]
#[serde(rename_all = "camelCase")]
pub struct SceneNode {
    pub tag: String,
    pub text: Option<String>, // New: For text nodes
    pub style: StyleConfig,
    pub children: Option<Vec<SceneNode>>,
}

#[derive(Deserialize, Serialize, Debug, Default)]
#[serde(rename_all = "camelCase")]
pub struct StyleConfig {
    pub width: Option<f32>,
    pub height: Option<f32>,
    pub backgroundColor: Option<String>,
    pub color: Option<String>, // Text color
    pub fontSize: Option<f32>,
    pub margin: Option<f32>,
    pub padding: Option<f32>,
    pub flex: Option<f32>,
    pub rotate: Option<f32>,
    pub scale: Option<f32>,
}

// ... (parse_color function remains the same) ...
fn parse_color(hex: &str) -> Color {
    let hex = hex.trim_start_matches('#');
    let (r, g, b, a) = match hex.len() {
        3 => {
            let r = u8::from_str_radix(&hex[0..1], 16).unwrap_or(0) * 17;
            let g = u8::from_str_radix(&hex[1..2], 16).unwrap_or(0) * 17;
            let b = u8::from_str_radix(&hex[2..3], 16).unwrap_or(0) * 17;
            (r, g, b, 255)
        },
        6 => {
            let r = u8::from_str_radix(&hex[0..2], 16).unwrap_or(0);
            let g = u8::from_str_radix(&hex[2..4], 16).unwrap_or(0);
            let b = u8::from_str_radix(&hex[4..6], 16).unwrap_or(0);
            (r, g, b, 255)
        },
        _ => (255, 0, 255, 255)
    };
    Color::from_rgba8(r, g, b, a)
}

#[wasm_bindgen]
pub fn render_frame(json_input: &str, width: u32, height: u32) -> Vec<u8> {
    let root_node: SceneNode = serde_json::from_str(json_input).unwrap();
    let font = Font::from_bytes(FONT_DATA, FontSettings::default()).unwrap();
    
    let mut taffy = Taffy::new();
    // ... (build_taffy_tree logic same as before) ...
    fn build_taffy_tree(taffy: &mut Taffy, node: &SceneNode) -> Node {
        let style = Style {
            size: Size {
                width: node.style.width.map(|v| Dimension::Points(v)).unwrap_or(Dimension::Auto),
                height: node.style.height.map(|v| Dimension::Points(v)).unwrap_or(Dimension::Auto),
            },
            ..Default::default()
        };
        let mut child_ids = vec![];
        if let Some(children) = &node.children {
            for child in children { child_ids.push(build_taffy_tree(taffy, child)); }
        }
        taffy.new_with_children(style, &child_ids).unwrap()
    }

    let root = build_taffy_tree(&mut taffy, &root_node);
    taffy.compute_layout(root, Size { 
        width: AvailableSpace::Definite(width as f32), 
        height: AvailableSpace::Definite(height as f32) 
    }).unwrap();

    let mut pixmap = Pixmap::new(width, height).unwrap();
    
    fn draw_node(taffy: &Taffy, node: &SceneNode, layout_id: Node, pixmap: &mut Pixmap, font: &Font, px: f32, py: f32) {
        let layout = taffy.layout(layout_id).unwrap();
        let x = px + layout.location.x;
        let y = py + layout.location.y;

        // 1. Draw Background
        if let Some(bg) = &node.style.backgroundColor {
            let mut paint = Paint::default();
            paint.set_color(parse_color(bg));
            if let Some(r) = tiny_skia::Rect::from_xywh(x, y, layout.size.width, layout.size.height) {
                pixmap.fill_rect(r, &paint, Transform::identity(), None);
            }
        }

        // 2. Draw Text (New!)
        if let Some(text_content) = &node.text {
            let size = node.style.fontSize.unwrap_or(32.0);
            let color = parse_color(node.style.color.as_deref().unwrap_or("#ffffff"));
            let mut curr_x = x;

            for c in text_content.chars() {
                let (metrics, bitmap) = font.rasterize(c, size);
                let mut char_pixmap = Pixmap::new(metrics.width as u32, metrics.height as u32).unwrap();
                
                // Convert fontdue alpha mask to RGBA
                for (i, alpha) in bitmap.iter().enumerate() {
                    let pixel_idx = i * 4;
                    char_pixmap.data_mut()[pixel_idx] = (color.red() * 255.0) as u8;
                    char_pixmap.data_mut()[pixel_idx+1] = (color.green() * 255.0) as u8;
                    char_pixmap.data_mut()[pixel_idx+2] = (color.blue() * 255.0) as u8;
                    char_pixmap.data_mut()[pixel_idx+3] = *alpha;
                }

                pixmap.draw_pixmap(
                    curr_x as i32 + metrics.xmin,
                    y as i32 + (size as i32 - metrics.height as i32 - metrics.ymin),
                    char_pixmap.as_ref(),
                    &PixmapPaint::default(),
                    Transform::identity(),
                    None
                );
                curr_x += metrics.advance_width;
            }
        }

        if let Some(children) = &node.children {
            let child_ids = taffy.children(layout_id).unwrap();
            for (i, child) in children.iter().enumerate() {
                draw_node(taffy, child, child_ids[i], pixmap, font, x, y);
            }
        }
    }

    draw_node(&taffy, &root_node, root, &mut pixmap, &font, 0.0, 0.0);
    pixmap.data().to_vec()
}

--------------------------------------------------
FILE: index.ts
--------------------------------------------------

console.log("Hello via Bun!");

--------------------------------------------------
FILE: lib/engine.ts
--------------------------------------------------

import { spawn } from "bun";
// @ts-ignore - Wasm package is built later
import { render_frame } from "../core/pkg/ubevid_core.js";
import type { RenderConfig, SceneNode } from "./types.js";

declare global {
  var _ubevid_frame: number;
}

export async function render(
  sceneComponent: () => SceneNode,
  config: RenderConfig,
  outputFile: string
) {
  const { width, height, fps, duration } = config;
  const totalFrames = fps * duration;

  console.log(`ðŸŽ¬ Ubevid Engine: Rendering ${totalFrames} frames...`);

  const ffmpeg = spawn([
    "ffmpeg", "-y", "-f", "rawvideo", "-pix_fmt", "rgba",
    "-s", `${width}x${height}`, "-r", `${fps}`,
    "-i", "-", "-c:v", "libx264", "-preset", "ultrafast",
    "-pix_fmt", "yuv420p", outputFile
  ], {
    stdin: "pipe",
    stdout: "ignore",
    stderr: "inherit",
  });

  const startTime = Date.now();

  for (let i = 0; i < totalFrames; i++) {
    globalThis._ubevid_frame = i;

    // TypeScript enforces the return type of the scene function
    const sceneGraph = sceneComponent(); 
    const jsonString = JSON.stringify(sceneGraph);
    
    // Call Rust
    const pixelBuffer = render_frame(jsonString, width, height) as Uint8Array;
    ffmpeg.stdin.write(pixelBuffer);

    if (i % 10 === 0) process.stdout.write(`.`);
  }

  ffmpeg.stdin.end();
  await ffmpeg.exited;

  const time = (Date.now() - startTime) / 1000;
  console.log(`\nâœ… Done! Saved to ${outputFile} in ${time.toFixed(2)}s`);
}

export function useFrame(): number {
  return globalThis._ubevid_frame || 0;
}

--------------------------------------------------
FILE: lib/types.ts
--------------------------------------------------

export interface StyleConfig {
  width?: number;
  height?: number;
  backgroundColor?: string;
  margin?: number;
  padding?: number;
  flex?: number;
  flexDirection?: "row" | "column";
  justifyContent?: "center" | "spaceBetween" | "flexStart" | "flexEnd";
  alignItems?: "center" | "flexStart" | "flexEnd";
  rotate?: number;
  scale?: number;
}
export interface SceneNode {
  tag: "view" | "rect" | "text";
  style: StyleConfig;
  children?: SceneNode[];
}

export interface RenderConfig {
  width: number;
  height: number;
  fps: number;
  duration: number;
}

--------------------------------------------------
FILE: package.json
--------------------------------------------------

{
  "name": "ubevid",
  "type": "module",
  "devDependencies": {
    "@types/bun": "latest"
  },
  "peerDependencies": {
    "typescript": "^5.0.0"
  }
}

--------------------------------------------------
FILE: sketches/hello.js
--------------------------------------------------

import { render, useFrame } from "../lib/engine.ts";

const config = {
  width: 1280,
  height: 720,
  fps: 30,
  duration: 3
};

function MyVideo() {
  const frame = useFrame();
  const t = frame / 30; // time in seconds

  const move = Math.sin(t * 3) * 300;
  const colorVal = Math.floor(Math.abs(Math.sin(t) * 255));
  const color = `#${colorVal.toString(16).padStart(2,'0')}0088`;

  return {
    tag: "view",
    style: {
      width: 1280,
      height: 720,
      backgroundColor: "#111",
      padding: 50,
      // Flexbox centering!
      flex: 1, 
    },
    children: [
      {
        tag: "rect",
        style: {
          width: 200,
          height: 200,
          backgroundColor: color,
          margin: 200 + move // Simple margin animation
        }
      }
    ]
  };
}

await render(MyVideo, config, "output.mp4");

--------------------------------------------------
FILE: sketches/spinning-boxes.js
--------------------------------------------------

import { render, useFrame } from "../lib/engine.ts";

const config = {
  width: 1080,
  height: 1080,
  fps: 60,
  duration: 5
};

function MyVideo() {
  const frame = useFrame();
  const t = frame / 60;

  return {
    tag: "view",
    style: {
      width: 1080,
      height: 1080,
      backgroundColor: "#050505",
      flexDirection: "column",
      justifyContent: "center",
      alignItems: "center"
    },
    children: [
      {
        tag: "rect",
        style: {
          width: 400,
          height: 400,
          backgroundColor: "#ff3e00",
          rotate: t * 180, // 180 degrees per second
          scale: 1 + Math.sin(t * 4) * 0.2, // Pulsing
          justifyContent: "center",
          alignItems: "center"
        },
        children: [
            {
                tag: "rect",
                style: {
                    width: 100,
                    height: 100,
                    backgroundColor: "#ffffff",
                    rotate: -t * 360 // Counter-rotation
                }
            }
        ]
      }
    ]
  };
}

await render(MyVideo, config, "pro_output.mp4");

--------------------------------------------------
FILE: tsconfig.json
--------------------------------------------------

{
  "compilerOptions": {
    "lib": ["ESNext"],
    "module": "esnext",
    "target": "esnext",
    "moduleResolution": "bundler",
    "strict": true,
    "allowJs": true,
    "noEmit": true,
    "skipLibCheck": true
  },
  "include": ["lib/**/*", "sketches/**/*"]
}

